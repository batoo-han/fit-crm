# Руководство по фронтенду CRM

## Установка и запуск

```bash
cd crm-frontend
npm install
npm run dev
```

Приложение будет доступно по адресу: http://localhost:3000

## Реализованные страницы

### 1. Login (Вход)
- Аутентификация через JWT
- Сохранение токена в localStorage
- Редирект на Dashboard после успешного входа

### 2. Dashboard (Главная)
- Общая статистика (клиенты, программы, выручка)
- Быстрые действия (ссылки на основные разделы)
- Карточки с ключевыми метриками

### 3. Clients (Клиенты)
- Список всех клиентов в таблице
- Фильтрация по статусу и этапу воронки
- Переход к детальной информации

### 4. ClientDetail (Детали клиента)
- Полная информация о клиенте
- Редактирование данных
- Список программ клиента
- История платежей
- Ссылка на дневник параметров

### 5. Pipeline (Воронка продаж)
- Kanban доска с этапами воронки
- Перетаскивание клиентов между этапами (через кнопки)
- Цветовая индикация этапов
- Счетчики клиентов на каждом этапе

### 6. Programs (Программы)
- Список всех программ
- Фильтрация (все/оплаченные/бесплатные)
- Информация о клиенте и типе программы
- Переход к просмотру программы

### 7. ProgramView (Просмотр программы)
- Отображение программы в табличном формате
- Текстовое представление
- Редактирование программы
- JSON данные (для разработки)

### 8. Progress (Дневник параметров)
- Таблица всех записей параметров
- График прогресса (вес, грудь, талия, ягодицы)
- Форма добавления новой записи
- Все параметры тела (вес, обхваты)

### 9. Analytics (Аналитика)
- Общая статистика
- График воронки продаж (Bar Chart)
- Распределение клиентов по этапам (Pie Chart)
- Статистика по выручке
- Детальная таблица по этапам

## Технологии

- **React 18** - UI библиотека
- **TypeScript** - типизация
- **Vite** - сборщик
- **React Router** - маршрутизация
- **TanStack Query** - управление состоянием и кэширование
- **Recharts** - графики и визуализация
- **Tailwind CSS** - стилизация
- **Axios** - HTTP клиент

## Структура компонентов

```
src/
├── pages/           # Страницы приложения
├── components/      # Переиспользуемые компоненты
│   ├── Layout.tsx   # Основной layout с сайдбаром
│   └── ProtectedRoute.tsx  # Защита маршрутов
├── contexts/        # React контексты
│   └── AuthContext.tsx  # Контекст аутентификации
├── services/        # API клиент
│   └── api.ts       # Axios конфигурация
└── App.tsx          # Главный компонент
```

## API интеграция

Все запросы к API идут через `/api` (проксируется на `http://127.0.0.1:8009`)

### Основные эндпоинты:
- `/api/auth/login` - вход
- `/api/auth/me` - текущий пользователь
- `/api/clients` - список клиентов
- `/api/clients/{id}` - детали клиента
- `/api/pipeline/stages` - этапы воронки
- `/api/programs` - список программ
- `/api/progress/{clientId}` - дневник параметров
- `/api/analytics/*` - аналитика

## Особенности

1. **Автоматическая аутентификация** - токен сохраняется и используется для всех запросов
2. **Кэширование данных** - React Query автоматически кэширует данные
3. **Оптимистичные обновления** - UI обновляется сразу после мутаций
4. **Адаптивный дизайн** - работает на всех устройствах
5. **Графики** - визуализация данных через Recharts

## Следующие шаги

1. Добавить поиск и фильтры
2. Добавить экспорт данных (Excel, PDF)
3. Добавить уведомления
4. Улучшить UI/UX
5. Добавить темную тему

