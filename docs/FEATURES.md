# Функциональные возможности платформы (для пользователей и администраторов)

Документ описывает ключевые разделы и функции системы, а также сценарии их использования. Материал структурирован так, чтобы им могли пользоваться и **пользователи** (клиенты), и **администраторы** (тренер/менеджер).

Оглавление:
- [1) Сайт и контактная форма](#1-сайт-и-контактная-форма)
- [2) Чат-виджет с ИИ](#2-чат-виджет-с-ии)
- [3) Telegram‑бот](#3-telegramбот)
- [4) CRM (клиенты, воронки, мультиворонки)](#4-crm-клиенты-воронки-мультиворонки)
- [5) Программы тренировок (генерация, редакция, выдача)](#5-программы-тренировок-генерация-редакция-выдача)
- [6) Платежи и статусы](#6-платежи-и-статусы)
- [7) Напоминания и автоматизация](#7-напоминания-и-автоматизация)
- [8) AI‑агент (FAQ, сценарии продаж, рекомендации)](#8-aiагент-faq-сценарии-продаж-рекомендации)
- [9) Настройки сайта и медиа‑загрузка](#9-настройки-сайта-и-медиа‑загрузка)
- [10) Маркетинг (кампании, аудитории, сообщения)](#10-маркетинг-кампании-аудитории-сообщения)
- [11) Управление доступом и безопасность](#11-управление-доступом-и-безопасность)

---

## 1) Сайт и контактная форма
- Что делает:
  - Позволяет оставить заявку (имя, контакты, интерес к услугам, сообщение).
  - Заявка автоматически попадает в CRM, создаётся/обновляется клиент, фиксируются действия и контакты.
  - Уведомления тренеру отправляются в Telegram.
  - Поддерживает онлайн-оплату тарифов с автоматической выдачей программы (при тарифах онлайн-сопровождения).
- Сценарии:
  - Новый посетитель оставляет заявку → в CRM создаётся клиент в стадии «Первичный контакт».
  - Повторная заявка с тем же телефоном/почтой обновляет карточку клиента и историю действий.
  - Клиент оплачивает тариф через модальное окно → создаётся платёж, формируется программа, письмо уходит автоматически.

## 2) Чат-виджет с ИИ
- Что делает:
  - Отвечает на вопросы посетителей сайта (FAQ → ИИ), ведёт диалог с памятью, задержкой ответа (имитация “человечности”).
  - Настраивается визуально и по логике (модель LLM, температура, приветствие).
  - Позиционирование и шрифты регулируются; виджет не перекрывает кнопку «Связаться».
- Сценарии:
  - Посетитель задаёт вопрос о цене → быстрый ответ из FAQ; если нет подходящего FAQ, отвечает ИИ.
  - Персонализированная консультация с сохранением истории.

## 3) Telegram‑бот
- Что делает:
  - Приветствие, ответы на частые вопросы, выдача демо‑программы, персональные рекомендации, напоминания.
  - Поддержка deep‑link от сайта (персональный токен); связывает лид с клиентом.
- Сценарии:
  - Клиент приходит из сайта по ссылке → бот приветствует персонально с учётом интересов.
  - Команда `/recommend` — выдаёт персональные советы и варианты программ.

## 4) CRM (клиенты, воронки, мультиворонки)
- Что делает:
  - Ведение базы клиентов: контакты, статус, текущая программа, история действий/перемещений.
  - Воронка продаж с этапами (по умолчанию «Первичный контакт» → «Консультация» → «Принимают решение» → «Куплена услуга» и т.д.).
  - Мультиворонки: можно создавать несколько воронок (SalesPipeline), называть, включать/отключать, привязывать этапы к выбранной воронке; система не допускает конкурирующих воронок для одного клиента одновременно (эксклюзивность обеспечивается через текущий этап клиента).
- Сценарии:
  - Админ создаёт вторую воронку для другой линейки продуктов; нужные этапы привязываются к этой воронке.
  - Клиент перемещается по этапам правилами автоматизации или вручную.

## 5) Программы тренировок (генерация, редакция, выдача)
- Что делает:
  - Генератор программ (полные и демо), форматирование текста, хранение структуры по неделям.
  - Редактирование в табличном виде, фильтрация по неделям, сохранение/отмена изменений.
  - Версионность программ (снимки и восстановление).
  - Экспорт в PDF и отправка клиенту (Telegram/Email).
- Сценарии:
  - В карточке клиента нажать «Сгенерировать полную программу» → выбрать длительность и локацию → перейти к редактированию.
  - Создать «Снимок версии», внести правки, при необходимости «Восстановить» прежнюю версию.
  - Отправить PDF клиенту в один клик.

## 6) Платежи и статусы
- Что делает:
  - Поддержка YooKassa (расширяется), вебхуки и периодические проверки статусов.
  - Автоматическое перемещение клиента в стадию «Куплена услуга» при успешной оплате, фиксация действия.
  - Обработка покупок с сайта: генерация платежа, запись метаданных, автоматическая выдача программы и отправка PDF.
- Сценарии:
  - Клиент оплачивает план → система фиксирует оплату, переводит по воронке, отмечает программу как «оплаченную».
  - Оплата с сайта → после webhook программа сохраняется в базе, письмо с PDF отправлено, Telegram-биндинг обновлён.

## 7) Напоминания и автоматизация
- Что делает:
  - Напоминания по демо‑программе (3/5/7 дней) с действиями и перемещением в воронке.
  - Отправка уведомлений через бот, клавиатуры действий.
- Сценарии:
  - Через 7 дней после демо — перевод в «Принимают решение» и отправка сообщения с предложением покупки.

## 8) AI‑агент (FAQ, сценарии продаж, рекомендации)
- Что делает:
  - FAQ из базы данных (CRUD, приоритеты, статистика использования).
  - Сценарии продаж — условия/шаблоны сообщений для подсказок и автоматизации.
  - Персональные рекомендации для клиента (бот/чат).
- Сценарии:
  - В админке настроить FAQ и сценарии; чат-виджет и бот сначала проверяют FAQ, затем обращаются к LLM.

## 9) Настройки сайта и медиа‑загрузка
- Что делает:
  - Вкладка «Настройки сайта»: шапка/подвал, контакты, цвета, шрифты, страницы, чат‑виджет.
  - Загрузка изображений (логотипы и др.) через `/api/uploads` → генерация URL `/uploads/...`.
- Сценарии:
  - Админ загружает логотип из файла (компьютер/телефон), поле URL заполняется автоматически.

## 10) Маркетинг (кампании, аудитории, сообщения)
- Что делает:
  - Создание кампаний (канал Telegram/Email/оба), сегментов (JSON‑фильтры), сообщений.
  - Запуск кампаний по сегментам с подсчётом метрик (отправлено/ошибки).
  - Предпочтения каналов и «тихие часы» на клиентском уровне.
- Сценарии:
  - Создать сегмент «status=client, has_telegram=true», подготовить сообщение и запустить рассылку.

## 11) Управление доступом и безопасность
- Что делает:
  - Уровни доступа (admin/trainer), авторизация в админ‑панели.
  - CORS для локальной разработки и продакшена (включая file:// сценарии).
  - Логирование (Loguru), разделение логов.

---

# Варианты использования по ролям

## Для клиента (пользователя)
- Оставить заявку на сайте → получить ссылку на Telegram‑бота → продолжить общение там.
- Общаться с ИИ‑ассистентом на сайте; получить персональные ответы.
- Получить демо‑программу; при оплате — полную программу в PDF.

## Для администратора/тренера
- Управлять клиентами и этапами воронки(ок); включать мультиворонки под разные продукты.
- Генерировать и редактировать программы, хранить версии, экспортировать в PDF и отправлять клиентам.
- Настраивать сайт и чат‑виджет; загружать логотипы и изображения.
- Вести маркетинговые кампании: сегменты, контент, запуск, контроль доставки.
- Поддерживать базу FAQ и сценариев продаж; расширять логику AI‑агента.

---

## Поддержание документации в актуальном состоянии
- Все функциональные изменения фиксируются в:
  - `docs/FEATURES.md` — реестр возможностей с описаниями и сценариями.
  - `docs/ADMIN_GUIDE.md` и `docs/USER_GUIDE.md` — практические инструкции.
- При доработках:
  - Обновляйте соответствующие разделы.
  - Вносите краткие примеры использования и ограничения (если появились).
  - Ставьте ссылку на новые разделы из `README.md`.


